#pragma once
#include "arlib.h"

typedef struct _GtkScrolledWindow GtkScrolledWindow;
typedef struct _GtkListStore GtkListStore;
typedef struct _GtkTreeRowReference GtkTreeRowReference;
typedef struct _GtkTreeView GtkTreeView;
typedef struct _GtkWidget GtkWidget;

class userview : nocopy {
	GtkTreeView* view;
	GtkScrolledWindow* scrollview;
	GtkListStore* store;
	map<string, GtkTreeRowReference*> members; // for remove(), GtkListStore has no search function
	
	function<void(cstrnul name)> activate_cb;
	
public:
	static userview* create();
	userview();
	
	void add(cstring name);
	void remove(cstring name);
	void clear();
	bool contains(cstring name) { return members.contains(name); }
	
	auto begin() -> decltype(members.keys().begin()) { return members.keys().begin(); }
	auto end()   -> decltype(members.keys().end())   { return members.keys().end();   }
	
	void onactivate(function<void(cstrnul name)> cb) { activate_cb = cb; }
	
	GtkWidget* gtkwidget() { return (GtkWidget*)scrollview; }
	
	~userview();
};
